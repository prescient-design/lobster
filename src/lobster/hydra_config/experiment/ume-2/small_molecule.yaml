# @package _global_

defaults:
  - ume-2/base

rdkit_descriptors:
  - MolWt
  - ExactMolWt
  - HeavyAtomCount
  - NumHAcceptors
  - NumHDonors
  - LabuteASA
  - MolMR
  - TPSA
  - Chi0n
  - Chi2v
  - Chi4n
  - Kappa1
  - MinAbsPartialCharge
  - MaxAbsPartialCharge
  - MinAbsEStateIndex
  - SlogP_VSA6
  - EState_VSA3
  - NumAliphaticCarbocycles
  - NumAromaticCarbocycles
  - BertzCT

data:
  datasets:
    - ZINC
  batch_size: 64
  dataset_kwargs:
    ZINC:
      extra_transform_fns:
        rdkit:
          _target_: lobster.transforms.SmilesToRDKitDescriptorsTransform
          normalize: true
          invert: true
          descriptor_list: ${rdkit_descriptors}

model:
  auxiliary_tasks:
    - _target_: lobster.model.ume2.AuxiliaryTask
      name: rdkit
      task_type: regression
      output_dim: 20
      hidden_size: null
      loss_weight: 0.1
      pooling: mean
      num_layers: 2
      dropout: 0.1
  lr: 1e-5
  scheduler_kwargs:
    num_warmup_steps: 10_000
  ckpt_path: null
  model_kwargs:
    model_size: mini

paths:
  timestamp: ${now:%Y-%m-%d}T${now:%H-%M-%S} 


# callbacks:
  # batch_size_finder:
  #   _target_: lightning.pytorch.callbacks.BatchSizeFinder
  #   mode: power
  #   steps_per_trial: 3
  #   init_val: 64
  #   max_trials: 25
  #   batch_arg_name: batch_size
