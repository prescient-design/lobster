# @package _global_

defaults:
  - override /model: hyena.yaml
  - override /data/transform_fn: hyena_tokenizer_transform.yaml

paths:
  root_dir: /data/bucket/freyn6/models/hyena_clm/debug

data:
  path_to_fasta: [
    '/data/bucket/freyn6/data/dna_subsequences.fasta',
  ]
  batch_size: 4
  num_workers: 8
  pin_memory: False
  lengths: [0.6,0.2,0.2]
  max_length: 512
  tokenizer_dir: ${model.tokenizer_dir}
  mlm: False

  transform_fn:
    tokenizer_dir: ${model.tokenizer_dir}
    max_length: ${data.max_length}
    mlm: False


trainer:
  # max_steps: 1_000_000_000
  num_sanity_val_steps: 0
  max_steps: 1_000
  val_check_interval: 1
  limit_val_batches: 1
  precision: 16
  gradient_clip_val: 0.5

model:
  model_name: hyena_mini
  tokenizer_dir: hyena_tokenizer
  max_length: ${data.max_length}
  num_warmup_steps: 100
  num_training_steps: ${trainer.max_steps}
  lr: 6e-4
